# Static Analysis Results Parser ReadMe

Date created:  20250123  
Last updated:  20250825  
Maintained by: Devin Patel

## Description
This all-in-one static analysis results parser will parse a set of output files from static analysis tools and collect them into one Excel or CSV file.
Inputs can be entered via GUI, guided terminal prompts, or json input.
Override rules can be defined in the config directory.
See surrounding comments in the overrides file for detailed help.

### Accepted Inputs:
-  AIO Parser: .xlsx OR .csv
-  Checkmarx:  Directory of .csv files (Single directory, no recursion)
-  CppCheck:   .xml
-  Coverity:   .json
-  Dep Check:  .csv
-  ESLint:     .json
-  Fortify:    .fpr (preferred) OR .csv
-  Gnat SAS:   .csv
-  NVD CVE:    .csv
-  Pragmatic:  .csv
-  Pylint:     .json
-  SRM:        .csv


## Execute using binaries

**Requirements:**
- Ensure the config folder is in the same directory as the executables.

**Instructions:**
- Double-click on the binary or execute them from the command line.
- No external dependencies are required to execute the binaries.



## Execute using interpretor

**Dependencies:**

Though not required, the program does use exernal modules for certain features.

```bash
$ pip install -r requirements.txt
```

**Execution:**

```bash
$ python3 parse-cli.py
  --or--
$ python3 parse-gui.py
```


## Build instructions:

**Requirements:**

External module `pyinstaller` must be installed.

```bash
$ pip install pyinstaller
```
    
Then execute the build script.



## Additional Notes:

1)  A user-writable config file can be created to quickly pass inputs in bulk.
    To generate this config file, run the parser once against valid input and check the config folder for "user_inputs.json."
    If any loaded data is changed in the guided prompts or GUI, "user_inputs.json" will be overwritten with the new data.

2)  The script can perform user-defined overrides on tool CWEs and Confidence values based on scanner message types.
    This does NOT affect the "Tool CWE" column, just the "CWE" column.
    These overrides are defined in "config/user_overrides.json" and can be enabled/disabled when prompted.
    To add or remove your own override rules, edit "config/user_overrides.json".
    Follow the formatting of the existing rules.

3)  A logfile will output any errors encountered while parsing.
    Additionally, the following potentially useful information will be logged:
    -  Configuration of inputs
    -  Number of findings output from each scanner parser
    The logfile is overwritten every time the script is executed, so be sure to save/rename logfiles if they are important.

4)  The finding ID is a SHA 256 hash generated by concatenating specific columns of each scanner into a string
    and hashing it. These columns are arbitrarily chosen, but they include the "meat" of a finding such as message,
    file path, line number, finding "type" or "category", and other relevant scanner information that adds to the
    finding's uniqueness.

5)  The following scanners overwrite what is defined in user input and will pull version info from the scanner's file:
    -  CppCheck
    -  Pragmatic

6)  If a Checkmarx input is specified, the output CSV will have 3 additional headings: DestPath, DestLine, and DestSymbol

7)  The CppCheck parser will attempt to filter out some scanner messages and will not output them to the combined CSV file.
    These are messages that are not relevant to any weaknesses/vulnerabilities and are about CppCheck internal behavior.
    The scanner messages with the following CppCheck IDs are filtered and printed to a separate CSV:
    -  templateRecursion
    -  checkLevelNormal
    -  checkersReport
    -  missingInclude
    -  missingIncludeSystem
    -  toomanyconfigs
    -  ConfigurationNotChecked
    -  normalCheckLevelMaxBranches

8)  In a bash terminal, the progress bar that gets printed may bug out if the terminal window is not sufficiently
    large enough. This has no effect on the behavior of the script but may create unclean or unreadable console output.


## Changelog:
```
20250818:
    Parser now accepts user input in a config file "user_inputs.json".
    To see formatting, run the parser once against valid input and check the config folder.

20250814:
    Parser now outputs as an Excel workbook by default UNLESS one of the following is true:
        1) The user requests CSV via prompt
        2) The user enters an outfile with a .csv extension
        3) External module "openpyxl" is not installed when running from src
    Minor bug fixes and fine-tuning.

20250805:
    A GUI version has been created.
    Please note that compatibility testing with legacy versions of python3 has not been performed, so older python3 versions may not be able to run the GUI.
    If this is the case, you may have to run the executables or update your python version.
	
	Significantly reworked the parser to be packaged as an executable that can be run without a python interpretor or the script dependencies.
    As of now, 64-bit executables have been built for Windows 10 and Ubuntu Linux. Support for other platforms can be requested.
	The source is still provided in case the executables do not work or if a user wants to add a custom feature.
    See section Execution Instructions for executing from source.

20250730:
    Implemented de-duping for OWASP DepCheck findings. OWASP has been found to output the same CVE number for multiple .dlls and .exes.
    The parser will now mark one CVE number as Confirmed and any rows with the same CVE as Duplicate.

    User overrides for AIO parser, OWASP DepCheck, and Manual CVEs now work.

20250717:
    User-defined CWE and Confidence overrides.
    Control flags for those overrides.
    See Note 2 for details on how to define override rules.
    
    ESLint parser now skips parser errors and ruleIDs that are null.

    Minor improvements to terminal UI.

20250716:
    Fixed bugs in input validation for CSVs created from AIO parser.
    Made minor changes in how Fortify messages are parsed.
    Fixed minor bug where the progress bar for Checkmarx did not calculate the total number of CSV rows correctly.

20250709:
    Added support for parsing AIO output CSVs. It will copy all findings from the input to the output.

20250708:
    Fixed a bug where a Windows absolute path will cause issues in guided prompts.
    Use commas to delineate file path and scanner, and use quotation marks to escape commas in file paths.

    Changed the line endings of all files from CRLF to LF for easier use on Linux systems.
    Limited testing showed that Windows interpretors will accept LF line endings.
    Note that older Python interpretors on Windows may not function well with LF line endings.

    Included an independent tool "Fetch NVD CVEs" to fetch CVE information when given a set of CVE numbers.
    This tool requires access to the internet and its output can be passed into parse.py.
    The script contains a header with instructions on installing dependencies and usage.

20250626:
    Fixed a bug where Pylint type and message columns were identical

20250610:
    Added more CWEs to Vulnerability Mappings that were not covered in Dependency Check output

20250606:
    Added support for ESLint
    Added support for manually fetched CVEs. It is recommended to use the script "Fetch NVD CVEs/fetch-nvd-cve.py" to generate the csv file.

20250519:
    Added a switch to turn off CWE vulnerability mappings in the output file. It is on by default.
    Fixed a bug where the coverity event history is not output correctly

20250516:
	Improved validity checks for file path inputs

20250430:
	Added support for OWASP Dependency Check
	Fixed bug where Coverity events were dropped from the message column
	Updated CWE 665 from vulnerability mapping "CATEGORY" to "DISCOURAGED"

20250224:
    Added an "ls" command to quickly view file names when entering scanner input files using guided prompts

20250221:
    Updated Fortify to significantly reduce long trace messages

20250205:
    Added two CppCheck message IDs to the list of informational IDs: templateRecursion, checkLevelNormal

20250129:
	Updated CppCheck parser to print filtered config errors to a CSV instead of the logfile
    Updated Coverity to significantly reduce clutter in the Message column

20250124:
    Updated Fortify parser to accomodate for certain missing XML tags and other minor fixes. Added new language_resolver module and included more file extentions.

20250123:
    Parser is uploaded to the share
```
