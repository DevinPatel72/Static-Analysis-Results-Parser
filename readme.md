# Static Analysis Results Parser

Maintained by: Devin Patel

## Description
The Static Analysis Results Parser (SARP) will parse a set of output files from static analysis tools and collect them into one Excel or CSV file. Inputs can be entered via GUI, guided terminal prompts, or [json input](#configure-bulk-inputs). [Override rules](#configure-overrides) can be defined in the config directory. See surrounding comments in the overrides file for detailed help.

### Accepted Inputs:
-  SARP:        `.xlsx` OR `.csv`
-  Checkmarx:   Directory of `.xml` (preferred) OR `.csv` files (Single directory, no recursion)
-  CppCheck:    `.xml`
-  Coverity:    `.json`
-  Dep Check:   `.json` or `.csv`
-  ESLint:      `.json`
-  Fortify:     `.fpr`
-  Gnat SAS:    `SARIF format` (preferred) or `.csv`
-  NVD CVE:     `.csv` (See [Batch-NVD-CVE](https://github.com/DevinPatel72/Batch-NVD-Query))
-  Pragmatic:   `.csv`
-  Pylint:      `.json`
-  Semgrep:     `.json` (preferred) OR `.csv`
-  Sigasi:      `.json`
-  SRM:         `.xml` (preferred) OR `.csv`


## Execute using binaries

**Requirements:**
- Ensure the config folder is in the same directory as the executables.

**Instructions:**
- Double-click on the binary or execute them from the command line.
- No external dependencies are required to execute the binaries.



## Execute using interpreter

**Dependencies:**

Though not required, SARP does use external modules for certain features.

```bash
$ pip install -r requirements.txt
```

**Execution:**

```bash
$ python3 parse-cli.py
  --or--
$ python3 parse-gui.py
```


## Build instructions

**Requirements:**

External modules `tkinter`, `openpyxl`, and `pyinstaller` must be installed.

```bash
$ pip install pyinstaller openpyxl
```

`tkinter` must be installed system-wide. Methods vary for [Windows](https://www.pythonguis.com/installation/install-tkinter-windows/) and [Linux](https://www.pythonguis.com/installation/install-tkinter-linux/).

Then execute the build script.


## Configure Bulk Inputs
A user-writable config file can be created to quickly pass inputs in bulk.
To generate this config file, run the parser once against valid input and check the config folder for "user_inputs.json."
If any loaded data is changed in the guided prompts or GUI, "user_inputs.json" will be overwritten with the new data.


## Configure Overrides
SARP can perform user-defined overrides on CWEs and Confidence values based on scanner message types.
This does NOT affect the "Tool CWE" column, just the "CWE" column.
These overrides are defined in "config/user_overrides.json" and can be enabled/disabled when prompted.
To add or remove your own override rules, edit "config/user_overrides.json."
Follow the formatting of the existing rules.

## Configure CWE Mappings
SARP allows configurable CWE mappings for scanners that do not output CWE data. A basic set of mappings are provided,
but users are able to edit and share them if they wish.


## Additional Notes:
1)  A logfile will output any errors encountered while parsing.
    Additionally, the following potentially useful information will be logged:
    -  Configuration of inputs
    -  Number of findings output for each scanner input
    
    The logfile is overwritten every time SARP is executed.

2)  If a Checkmarx input is specified, the output CSV will have 3 additional headings: DestPath, DestLine, and DestSymbol

3)  The CppCheck parser will attempt to filter out some scanner messages and will not output them to the combined CSV file.
    These are messages that are not relevant to any weaknesses/vulnerabilities and are about CppCheck internal behavior.
    The scanner messages with the following CppCheck IDs are filtered and printed to a separate CSV:
    -  templateRecursion
    -  checkLevelNormal
    -  checkersReport
    -  missingInclude
    -  missingIncludeSystem
    -  toomanyconfigs
    -  ConfigurationNotChecked
    -  normalCheckLevelMaxBranches

4)  The following scanners overwrite what is defined in user input and will pull version info from the scanner's file:
    -  Checkmarx
    -  CppCheck
    -  Pragmatic
    -  Semgrep
    -  SRM

5)  The finding ID is a SHA 256 hash generated by concatenating specific columns of each scanner into a string
    and hashing it. These columns are arbitrarily chosen, but they include the "meat" of a finding such as message,
    file path, line number, finding "type" or "category", and other relevant scanner information that adds to the
    finding's uniqueness.

6)  In a bash terminal, the progress bar that gets printed may bug out if the terminal window is not sufficiently
    large enough. This has no effect on the behavior of SARP but may create unclean or unreadable console output.
